% Final thing is style report, not article.
\documentclass[12pt,a4paper]{report}

\usepackage{algpseudocode}
\usepackage{color}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{tabularx}
\usepackage{rotating}
\usepackage{subfigure}
\usepackage{amssymb}
\usepackage{xspace}

\newbox\subfigbox             % Create a box to hold the subfigure.
\makeatletter
  \newenvironment{subfloat}% % Create the new environment.
    {\def\caption##1{\gdef\subcapsave{\relax##1}}%
     \let\subcapsave=\@empty % Save the subcaption text.
     \let\sf@oldlabel=\label
     \def\label##1{\xdef\sublabsave{\noexpand\label{##1}}}%
     \let\sublabsave\relax    % Save the label key.
     \setbox\subfigbox\hbox
       \bgroup}%              % Open the box...
      {\egroup                % ... close the box and call \subfigure.
     \let\label=\sf@oldlabel
     \subfigure[\subcapsave]{\box\subfigbox}}%
\makeatother

\usetikzlibrary{arrows,decorations.pathmorphing,decorations.markings,backgrounds,positioning,fit,petri,automata,shapes,petri}

\pgfdeclarelayer{bg}
\pgfsetlayers{bg,main}

% MGK recommends these formatting settings:

% for hard-bound final submission, use:
\setlength{\oddsidemargin}{4.6mm}     % 30 mm left margin - 1 in
% for soft-bound version and techreport, use instead:
%\setlength{\oddsidemargin}{-0.4mm}    % 25 mm left margin - 1 in
\setlength{\evensidemargin}{\oddsidemargin}
\setlength{\topmargin}{-5.4mm}        % 20 mm top margin - 1 in
\setlength{\textwidth}{160mm}         % 20/25 mm right margin
\setlength{\textheight}{247mm}        % 20 mm bottom margin
\setlength{\headheight}{5mm}
\setlength{\headsep}{5mm}
\setlength{\parindent}{0mm}
\setlength{\parskip}{\medskipamount}
\renewcommand\baselinestretch{1.2}
\renewcommand\topfraction{.9}
\renewcommand\textfraction{.1}
\renewcommand\floatpagefraction{.8}

\author{Steven Smith}
\title{SLI: Speculative Lock Insertion}
\begin{document}

\tikzset{CfgInstr/.style={rectangle,minimum size=6mm}}
\tikzset{TrueCfgInstr/.style={rectangle,minimum size=6mm,fill=blue!50}}
\tikzset{DupeCfgInstr/.style={rectangle,minimum size=6mm,fill=blue!10}}
\tikzset{NewCfgInstr/.style={rectangle,minimum size=6mm,fill=red!50}}
\tikzset{stateSideEffect/.style={rectangle,draw}}
\tikzset{stateIf/.style={ellipse,draw}}
\tikzset{stateTerminal/.style={ellipse,draw}}
\tikzset{flowChartState/.style={rectangle,draw}}
\tikzset{killEdge/.style={decorate,decoration={snake,segment length=1mm,post length=0.4mm}}}
\tikzset{swungEdge/.style={color=red}}
\tikzset{happensBeforeEdge/.style={dashed}}
\tikzset{ifTrue/.style={}}
\tikzset{ifFalse/.style={dotted}}
\newcommand{\draftonly}[1]{#1}
\newcommand{\editorial}[1]{\draftonly{\textcolor{red}{\footnote{\textcolor{red}{#1}}}}}
\newcommand{\smh}[1]{\draftonly{\textcolor{green}{\footnote{\textcolor{green}{#1}}}}}
\newcommand{\needCite}{\draftonly{\editorial{need cite}}}
\newcommand{\todo}[1]{\draftonly{\textcolor{red}{#1}}}
\newcommand{\StateMachine}{program slice }
\newcommand{\StateMachines}{program slices }
\newcommand{\STateMachine}{Program slice }
\newcommand{\STateMachines}{Program slices }
\newcommand{\CrashSummary}{crash summary }
\newcommand{\CrashSummaries}{crash summaries }
\newcommand{\happensBefore}{\leftarrowtail}
\newcommand{\controlEdge}[2]{Control(#1 \rightarrow #2)}

\newcommand{\concatDynTraces}{\oplus}
\newcommand{\interleaveDynTraces}{\otimes}
\newcommand{\survive}{\top}
\newcommand{\crash}{\bot}
\newcommand{\queue}[1]{\{#1\}}
\newcommand{\map}[1]{\{#1\}}
\newcommand{\mapIndex}[2]{#1[#2]}
\newcommand{\state}[1]{\textsc{#1}}
\newcommand{\implementation}{\textcolor{blue}{implementation}}
\newcommand{\technique}{\textcolor{blue}{technique}}
\newcommand{\Implementation}{\textcolor{blue}{Implementation}}
\newcommand{\Technique}{\textcolor{blue}{Technique}}

\maketitle
\tableofcontents

\chapter{Abstract}
\input{abstract}

\chapter{Introduction}
\input{introduction}

\chapter{Deriving and manipulating \StateMachines}
\input{derive_and_manip}

\chapter{Using \StateMachines}
\input{using_machines}

\chapter{Evaluation}
\input{evaluation}

\chapter{Related work}
\input{related_work}

\chapter{Conclusions}
\input{conclusions}

\todo{I should really have more discussion of memory models.  I'm assuming strongly consistent, but don't really say that anywhere.}

\bibliographystyle{plain}
\bibliography{$HOME/mendeley.bib/library}

\end{document}

